<!DOCTYPE html>
<html>
  <title>Manage Request</title> 
  <body>
    <h3>Manage Request</h3>  
    <table cellspacing="2" align="center" cellpadding="8" border="0">  
      <tr><td>Comments</td></tr>  
      <tr><td><input type="text" placeholder="Comments" id="co"></td></tr>  
      <tr><td>  
      <input type="button" onclick="onApprove()" value="Approve">
      <input type="button" onclick="onReject()" value="Reject">
    </table>  
    <script>
      function onApprove(urlString) {
        var Co=document.getElementById("co").value; 
        let params = readSearchParams();
      
        var Url="https://script.google.com/a/macros/envases.dk/s/AKfycbzVrPsljDBZjxYCiCRylqv6dGa5YsLWJOC3ZlHNw6erqkVYDlLbOFrPu5kZc5bkJ0NGdA/exec";
        Url = Url + "?Id="+params.Id+"&SpId="+params.SpId+"&Com="+Co+"&Res=Approved";
        window.location=Url;
      }
      function onReject(urlString) {
        var Co=document.getElementById("co").value; 
        let params = readSearchParams();
        
        var url="https://script.google.com/a/macros/envases.dk/s/AKfycbzVrPsljDBZjxYCiCRylqv6dGa5YsLWJOC3ZlHNw6erqkVYDlLbOFrPu5kZc5bkJ0NGdA/exec";
        Url = Url + "?Id="+params.Id+"&SpId="+params.SpId+"&Com="+Co+"&Res=Rejected";
        window.location=Url;
      }
      function readSearchParams() {
        let usp = new URLSearchParams(window.location.search);
        let params = {};
        usp.forEach((value, key) => {
          if (!params[key]) {
            params[key] = [];
          }
          params[key].push(value);
        });
        return params;
      }      
    </script>
  </body>
</html>
